
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Methods #1: Introduction &#8212; Birth Outcomes</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js?v=afe5de03"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script src="https://unpkg.com/mermaid@10.2.0/dist/mermaid.min.js"></script>
    <script>mermaid.initialize({startOnLoad:true});</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'design_methods_1_intro';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Methods #2: Conventional approaches" href="design_methods_2_conventional.html" />
    <link rel="prev" title="Causal estimands" href="design_causal_estimands.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
  
    <p class="title logo__title">Birth Outcomes</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Birth outcomes summary
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Background</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="stages.html">Stages of pregnancy and birth</a></li>
<li class="toctree-l1"><a class="reference internal" href="interventions.html">Interventions during labour</a></li>
<li class="toctree-l1"><a class="reference internal" href="research_groups.html">Research groups</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Identifying HIE cases</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="neo_out_background.html">Examples of identifying hypoxic ischaemic encephalopathy (HIE)</a></li>
<li class="toctree-l1"><a class="reference internal" href="neo_out_summary.html">Summary of possible indicators</a></li>
<li class="toctree-l1"><a class="reference internal" href="neo_out_cooling.html">Therapeutic hypothermia</a></li>
<li class="toctree-l1"><a class="reference internal" href="neo_out_hie_diagnosis.html">Diagnostic codes for HIE</a></li>
<li class="toctree-l1"><a class="reference internal" href="neo_out_blood.html">Umbilical cord blood gas analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="neo_out_sentinel.html">Sentinel events</a></li>
<li class="toctree-l1"><a class="reference internal" href="neo_out_resus.html">Resuscitation</a></li>
<li class="toctree-l1"><a class="reference internal" href="neo_out_meconium.html">Meconium-stained amniotic fluid</a></li>
<li class="toctree-l1"><a class="reference internal" href="neo_out_care.html">Transfer to neonatal care services</a></li>
<li class="toctree-l1"><a class="reference internal" href="neo_out_cp.html">Cerebral palsy</a></li>
<li class="toctree-l1"><a class="reference internal" href="neo_out_mri.html">Neuroimaging evidence</a></li>
<li class="toctree-l1"><a class="reference internal" href="neo_out_enceph_symptoms.html">Symptoms of neonatal encephalopathy (NE)</a></li>
<li class="toctree-l1"><a class="reference internal" href="neo_out_apgar.html">Apgar scores</a></li>
<li class="toctree-l1"><a class="reference internal" href="neo_out_death.html">Death</a></li>
<li class="toctree-l1"><a class="reference internal" href="neo_out_ctg.html">Abnormal CTG</a></li>

</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Study design - causal diagrams</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="design_introduction_causality.html">The problem: prediction, causation and the treatment paradox</a></li>
<li class="toctree-l1"><a class="reference internal" href="design_dag_1.html">Introduction to directed acyclic graphs (DAGs)</a></li>
<li class="toctree-l1"><a class="reference internal" href="design_dag_2.html">Additional DAG concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="design_dag_hie.html">DAG for HIE</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Study design - causal methods</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="design_causal_assumptions.html">Causal assumptions</a></li>
<li class="toctree-l1"><a class="reference internal" href="design_causal_estimands.html">Causal estimands</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Methods #1: Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="design_methods_2_conventional.html">Methods #2: Conventional approaches</a></li>
<li class="toctree-l1"><a class="reference internal" href="design_methods_3_gmethods.html">Methods #3: G-methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="design_methods_4_unobserved.html">Methods #4: Methods for unobserved confounding</a></li>
<li class="toctree-l1"><a class="reference internal" href="design_methods_5_other.html">Methods #5: Other</a></li>
<li class="toctree-l1"><a class="reference internal" href="design_account_paradox.html">Accounting for a treatment paradox</a></li>
<li class="toctree-l1"><a class="reference internal" href="design_examples.html">Examples of studies that account for the treatment paradox</a></li>
<li class="toctree-l1"><a class="reference internal" href="design_other.html">Other design considerations</a></li>
<li class="toctree-l1"><a class="reference internal" href="design_plan.html">Design plans</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Appendices - archived or tbc</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="neo_out_enceph_treatment_outcomes.html">Challenge 2: Outcomes for trials</a></li>
<li class="toctree-l1"><a class="reference internal" href="neo_out_chorio.html">More on chorioamnionitis</a></li>
<li class="toctree-l1"><a class="reference internal" href="fetal_risk_factors.html">Fetal risk factors</a></li>
<li class="toctree-l1"><a class="reference internal" href="cardiotocography.html">Cardiotocography</a></li>
<li class="toctree-l1"><a class="reference internal" href="parental_outcomes.html">Parental outcomes</a></li>
<li class="toctree-l1"><a class="reference internal" href="routine_data.html">Routinely collected data</a></li>
<li class="toctree-l1"><a class="reference internal" href="key_papers.html">Key Papers</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fdesign_methods_1_intro.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/design_methods_1_intro.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Methods #1: Introduction</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#designing-a-study-to-estimate-a-causal-effect-from-observational-data">Designing a study to estimate a causal effect from observational data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#groups-of-methods-for-causal-effect-estimation">Groups of methods for causal effect estimation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#conditional-v-s-marginal-effect-measures">Conditional v.s. marginal effect measures</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#current-practice">Current practice</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mapping-review-of-confounding-adjustment-methods-used-for-longitudinal-observational-data">2022 mapping review of confounding adjustment methods used for longitudinal observational data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-you-shouldn-t-do">What you shouldn’t do</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#all-possible-confounders">All possible confounders</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-driven-selection-of-confounders">Data-driven selection of confounders</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adjust-for-time-varying-confounders-using-conventional-methods">Adjust for time-varying confounders using conventional methods</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rough-notes">ROUGH NOTES…</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#additional-counterfactual-prediction-modelling">Additional: counterfactual prediction modelling</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#when-can-prediction-models-answer-causal-questions">When can prediction models answer causal questions?</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="methods-1-introduction">
<h1>Methods #1: Introduction<a class="headerlink" href="#methods-1-introduction" title="Link to this heading">#</a></h1>
<div class="info admonition">
<p class="admonition-title">Executive summary</p>
<p>Methods for causal effect estimation.</p>
<p><strong>Conventional methods:</strong></p>
<ul class="simple">
<li><p>(Principal) Stratification</p></li>
<li><p>Matching</p></li>
<li><p>Inverse probability of treatment weighting (IPTW)</p></li>
<li><p>Multivariable regression</p></li>
</ul>
<p><strong>G-methods:</strong></p>
<ul class="simple">
<li><p>G-computation (/ parametric G-formula / G-standardisation / standardisation / outcome regression)</p></li>
<li><p>Marginal structure models</p></li>
<li><p>G-estimation</p></li>
</ul>
<p><strong>Methods to address unobserved confounding:</strong></p>
<ul class="simple">
<li><p>Instrumental variables</p></li>
<li><p>Regression discontinuity (RD)</p></li>
<li><p>Interrupted time series (ITS)</p></li>
<li><p>Difference in differences (DiD)</p></li>
</ul>
<p><strong>Other methods:</strong></p>
<ul class="simple">
<li><p>Marginal, asymmetric conditional, and causal SHAP values</p></li>
<li><p>Synthetic control</p></li>
<li><p>Matrix completion</p></li>
<li><p>Causal discover</p></li>
<li><p>Double machine learning</p></li>
<li><p>Causal forests</p></li>
<li><p>Strucrtural estimation</p></li>
</ul>
</div>
<p><mark> where does difference in differences fit in? </mark> <a class="reference external" href="https://dimewiki.worldbank.org/Difference-in-Difference">https://dimewiki.worldbank.org/Difference-in-Difference</a></p>
<p><mark>continue to use this textbook throughout</mark> <a class="reference external" href="https://www.hsph.harvard.edu/miguel-hernan/wp-content/uploads/sites/1268/2024/01/hernanrobins_WhatIf_2jan24.pdf">https://www.hsph.harvard.edu/miguel-hernan/wp-content/uploads/sites/1268/2024/01/hernanrobins_WhatIf_2jan24.pdf</a></p>
<p><mark>read this - may help with where difference in differences fits in - andjust generally looks good</mark> <a class="reference external" href="https://www2.stat.duke.edu/~fl35/CausalInferenceClass.html">https://www2.stat.duke.edu/~fl35/CausalInferenceClass.html</a></p>
<p><mark>Will need to integrate with the page on methods to account for treatment paradox</mark></p>
<p><mark>haven’t covered bayesian causal inference</mark>… <a class="reference external" href="https://royalsocietypublishing.org/doi/10.1098/rsta.2022.0153">https://royalsocietypublishing.org/doi/10.1098/rsta.2022.0153</a> and <a class="reference external" href="http://www2.stat.duke.edu/~fl35/BayesianCausalInference.html">http://www2.stat.duke.edu/~fl35/BayesianCausalInference.html</a></p>
<p>erik shared these to have a look at:</p>
<ul class="simple">
<li><p>I would also very much recommend <a class="reference external" href="https://theeffectbook.net/">The Effect: An Introduction to Research Design and Causality by Nick Huntington-Klein</a></p></li>
<li><p>I’ve heard good things about <a class="reference external" href="https://mixtape.scunning.com/">Causal Inference: The Mixtape by Scott Cunningham</a></p></li>
</ul>
<section id="designing-a-study-to-estimate-a-causal-effect-from-observational-data">
<h2>Designing a study to estimate a causal effect from observational data<a class="headerlink" href="#designing-a-study-to-estimate-a-causal-effect-from-observational-data" title="Link to this heading">#</a></h2>
<p>The gold standard method for inferring causality is randomisation - e.g. randomising patients to receive a treatment or not. This is because it removes confounding - it removes the common cause of the treatment and outcome, since the only cause of treatment was randomisation.<a class="reference external" href="https://learning.edx.org/course/course-v1:HarvardX+PH559x+2T2020/home">[HarvardX PH559x]</a></p>
<p>When we are using <strong>observational data</strong>, there are a variety of possible methods for <strong>causal effect estimation</strong>. They all rely on assumptions (although those cannot always be tested).</p>
<p>When designing a study, you need to:</p>
<ol class="arabic simple">
<li><p>Clearly specify the <strong>research question</strong> in terms of a <strong>causal estimand</strong></p></li>
<li><p>This allows you to <strong>choose an appropriate method</strong> for this estimand, and to carefully interrogate the influence of biases using <strong>sensitivity and quantitative bias analysis</strong>. <a class="reference external" href="https://doi.org/10.1136/jech-2022-219267">[Igelström et al. 2022]</a></p></li>
</ol>
</section>
<section id="groups-of-methods-for-causal-effect-estimation">
<h2>Groups of methods for causal effect estimation<a class="headerlink" href="#groups-of-methods-for-causal-effect-estimation" title="Link to this heading">#</a></h2>
<p>Methods for causal effect estimation can be broadly grouped into:</p>
<ul class="simple">
<li><p><strong>Conventional methods</strong></p></li>
<li><p><strong>G-methods</strong> (which address treatment-confounder feedback)</p></li>
<li><p><strong>Methods to address unobserved confounding</strong> [no source]</p></li>
</ul>
<section id="conditional-v-s-marginal-effect-measures">
<h3>Conditional v.s. marginal effect measures<a class="headerlink" href="#conditional-v-s-marginal-effect-measures" title="Link to this heading">#</a></h3>
<p>Different methods will produce effect measures that are <strong>conditional</strong> (specific to certain population) or <strong>marginal</strong> (relevant to whole population).</p>
<p><strong>Non-collapsibility</strong> refers to a phenomenon where a conditional effect measure differs from the marginal effect measure even in the absence of confounding. This is true for certain non-linear effect measures like the odds ratio</p>
<ul class="simple">
<li><p>This may make conditional measures more <strong>difficult to compare</strong> between studies (since different studies typically adjust for different sets of covariates)</p></li>
<li><p>On the other hand, marginal effeccts may be <strong>less transportable</strong> between populations <a class="reference external" href="https://doi.org/10.1093/aje/kwq474">[Vansteelandt and Keiding 2011]</a></p></li>
</ul>
</section>
</section>
<section id="current-practice">
<h2>Current practice<a class="headerlink" href="#current-practice" title="Link to this heading">#</a></h2>
<section id="mapping-review-of-confounding-adjustment-methods-used-for-longitudinal-observational-data">
<h3>2022 mapping review of confounding adjustment methods used for longitudinal observational data<a class="headerlink" href="#mapping-review-of-confounding-adjustment-methods-used-for-longitudinal-observational-data" title="Link to this heading">#</a></h3>
<p>Wijn et al. 2022 conducted a mapping literature review to determine which confounding adjustment methods were used in longitudinal observational data to estimate a treatment effect. They identified the following studies:</p>
<p align='center'>
    <img src='images/wijn_2022_methods.png'>
     <i>Abbreviations: CA, covariate adjustment; IPW, inverse probability weighting; PS, propensity score; PSM, propensity score matching; TdPSM, time-dependent propensity score matching.</i>
</p>
<p>You can see that in the context of <strong>longitudinal observational</strong> data</p>
<ul class="simple">
<li><p>66% time-varying treatment, 26% treatment at baseline, 8% time of treatment not clearly defined</p></li>
<li><p>For <strong>treatment at baseline</strong>, majority of papers use propensity score matching with baseline covariates (82%)</p></li>
<li><p>For <strong>time-varying treatment</strong>:</p>
<ul>
<li><p>30% inverse probability weighting</p></li>
<li><p>25% propensity score matching with baseline coavariates</p></li>
<li><p>14% propensity score matching with baseline covariates combined with time-dependent Cox regression</p></li>
<li><p>10% covariate adjustment using propensity score</p></li>
<li><p>8% time-dependent propensity score</p></li>
<li><p>4% parametric G-formula</p></li>
<li><p>2% propensity score stratification</p></li>
<li><p>3% G-estimation</p></li>
</ul>
</li>
<li><p>Hence, for time-varying treatment, often <strong>inappropriate methods</strong> are use - 25% used probability score matching with baseline covariates ‘which can potentially result in a biased treatment effect’ - and only 45% of the papers used g-methods. <a class="reference external" href="https://doi.org/10.1136/bmjopen-2021-058977">[Wijn et al. 2022]</a></p></li>
</ul>
<p>Other reviews include -</p>
<ul class="simple">
<li><p>2019 systematic review of studies adjusting for time-dependent confounding, finds <strong>inverse probability of treatment weighting estimated marginal structure models</strong> to be the most common technique <a class="reference external" href="https://doi.org/10.1093/ije/dyy218">[Clare et al. 2019]</a></p></li>
</ul>
</section>
</section>
<section id="what-you-shouldn-t-do">
<h2>What you shouldn’t do<a class="headerlink" href="#what-you-shouldn-t-do" title="Link to this heading">#</a></h2>
<section id="all-possible-confounders">
<h3>All possible confounders<a class="headerlink" href="#all-possible-confounders" title="Link to this heading">#</a></h3>
<p>‘Many analysts take the strategy of putting in <strong>all possible confounders</strong>. This can be bad news, because adjusting for <strong>colliders and mediators can introduce bias</strong>, as we’ll discuss shortly. Instead, we’ll look at <strong>minimally sufficient adjustment sets</strong>: sets of covariates that, when adjusted for, block all back-door paths, but include no more or no less than necessary. That means there can be many minimally sufficient sets, and if you remove even one variable from a given set, a back-door path will open.’<a class="reference external" href="https://cran.r-project.org/web/packages/ggdag/vignettes/intro-to-dags.html">[source]</a></p>
<p><a class="reference external" href="https://doi.org/10.1097/EDE.0b013e3181a819a1">Schisterman et al. 2009</a> ‘define <strong>unnecessary adjustment</strong> as control for a variable that does not affect bias of the causal relation between exposure and outcome but may affect its precision.’ - so:</p>
<ul class="simple">
<li><p>Adjusting for a variable completely outside the system of interest (C1)</p></li>
<li><p>Adjusting for a variable that causes the exposure only (C2)</p></li>
<li><p>Adjusting for a variable whose only causal association with variables of interest is as a descendent of the exposure and not in the causal pathway (C3)</p></li>
<li><p>Adjusting for a variable whose only causal association with variables of interest is as a cause of the outcome (C4)</p></li>
</ul>
<p>Adjusting for these varaibles should not impact the total causal effect on the outcome, but may be gain or loss in precision of relationship between exposure of interest, the unnecessary adjustment variables, and the outcome of interest.<a class="reference external" href="https://doi.org/10.1097/EDE.0b013e3181a819a1">[Schisterman et al. 2009]</a></p>
<div class="mermaid">
              flowchart LR;

    C1:::white
    C2:::white
    C3:::white
    C4:::white
    E(Exposure):::white
    D(Outcome):::white

    C2 --&gt; E;
    E --&gt; C3;
    E --&gt; D;
    C4 --&gt; D;

    classDef white fill:#FFFFFF, stroke:#FFFFFF
        </div></section>
</section>
<section id="data-driven-selection-of-confounders">
<h2>Data-driven selection of confounders<a class="headerlink" href="#data-driven-selection-of-confounders" title="Link to this heading">#</a></h2>
<p>‘Though generally not advisable, data-driven confounder selection may be employed in small datasets, under the condition that the data has been pre-processed to entail that covariates fed into the statistical selection method are only potential confounders and free of mediators’.<a class="reference external" href="https://doi.org/10.1007/s10654-021-00794-w">[Ramspek et al. 2021 (supplementary)]</a></p>
</section>
<section id="adjust-for-time-varying-confounders-using-conventional-methods">
<h2>Adjust for time-varying confounders using conventional methods<a class="headerlink" href="#adjust-for-time-varying-confounders-using-conventional-methods" title="Link to this heading">#</a></h2>
<p>‘Adjusting for time-dependent confounders using conventional methods, such as time-dependent Cox regression, often fails in these circumstances, as adjusting for time-dependent confounders affected by past exposure (i.e. in the role of mediator) may inappropriately block the effect of the past exposure on the outcome (i.e. overadjustment bias). For example, we wish to determine the effect of blood pressure measured over time (as our time-varying exposure) on the risk of end-stage kidney disease (ESKD) (outcome of interest), adjusted for eGFR measured over time (time-dependent confounder). As eGFR acts as both a mediator in the pathway between previous blood pressure measurement and ESKD risk, as well as a true time-dependent confounder in the association between blood pressure and ESKD, simply adding eGFR to the model will both correct for the confounding effect of eGFR as well as bias the effect of blood pressure on ESKD risk (i.e. inappropriately block the effect of previous blood pressure measurements on ESKD risk).’ <a class="reference external" href="https://doi.org/10.1093%2Fckj%2Fsfab158">[Chesnaye et al. 2022]</a></p>
</section>
<section id="rough-notes">
<h2>ROUGH NOTES…<a class="headerlink" href="#rough-notes" title="Link to this heading">#</a></h2>
</section>
<section id="additional-counterfactual-prediction-modelling">
<h2>Additional: counterfactual prediction modelling<a class="headerlink" href="#additional-counterfactual-prediction-modelling" title="Link to this heading">#</a></h2>
<p>In the case of <strong>counterfactual prediction modelling</strong> (which answers ‘what if’ questions on prognosis related to interventions) <strong>prediction and etiology intentionally collide</strong>.<a class="reference external" href="https://link.springer.com/article/10.1007/s10654-021-00794-w">[Ramspek et al. 2021]</a></p>
<p><mark>look into this</mark></p>
<section id="when-can-prediction-models-answer-causal-questions">
<h3>When can prediction models answer causal questions?<a class="headerlink" href="#when-can-prediction-models-answer-causal-questions" title="Link to this heading">#</a></h3>
<p>As this example is from a simulation study where know true causal effects, we can plot the SHAP values from the prediction models v.s. the known true causal effects.</p>
<p><img alt="Causal effects" src="_images/shap_bugs_causal_vs_shap.png" /></p>
<p>We can also add clustering to see the redundancy structure of the data as a dendrogram - ‘when features merge together at the bottom (left) of the dendrogram it means that that the information those features contain about the outcome (renewal) is very redundant and the model could have used either feature. When features merge together at the top (right) of the dendrogram it means the information they contain about the outcome is independent from each other.’</p>
<p><img alt="Redundancy" src="_images/shap_bugs_redundancy.png" /></p>
<p><strong>When can predictive models answer causal questions?</strong> When the feature is independent of (a) other features in the model, and (b) unobserved confounders. Hence, it is not subject to bias from either unmeasured confounders or feature redundancy. Example: Economy</p>
<ul class="simple">
<li><p>Independent from other features in dendogram (no observed confounding)</p></li>
<li><p>No unobserved confounding in causal digram</p></li>
</ul>
<p><strong>When can they not be used? (1) When you have observed confounding.</strong> Example: Ad Spend (no direct causal effect on retention, but correlated with Last upgrade and Monthly usage which do drive retention). ‘Our predictive model identifies Ad Spend as the one of the best single predictors of retention because it captures so many of the true causal drivers through correlations. XGBoost imposes regularization, which is a fancy way of saying that it tries to choose the simplest possible model that still predicts well. If it could predict equally well using one feature rather than three, it will tend to do that to avoid overfitting.’</p>
<p>However, there are methods to deal with observed confounding, such as double/debiased machine learning model. This involves:</p>
<ol class="arabic simple">
<li><p>Train model to predict feature (Ad spend) using set of confounders (features not caused by Ad spend)</p></li>
<li><p>Train model to predict outcome (Did Renew) using that set of confounders</p></li>
<li><p>Train model to predict residual variation of outcome (the variation left after subtracting our prediction) using the residual variation of the causal feature of interest</p></li>
</ol>
<p>‘The intuition is that if Ad Spend causes renewal, then the part of Ad Spend that can’t be predicted by other confounding features should be correlated with the part of renewal that can’t be predicted by other confounding features.’ There are packages like econML’s LinearDML for this.</p>
<p><strong>When can they not be used? (2) When you have non-confounding redundancy.</strong> ‘This occurs when the feature we want causal effects for causally drives, or is driven by, another feature included in the model, but that other feature is not a confounder of our feature of interest.’</p>
<p>Example: Sales Calls directly impact retention, but also have an indirect effect on retention through Interactions. We can see this in the SHAP scatter plots above, which show how XGBoost underestimates the true causal effect of Sales Calls because most of that effect got put onto the Interactions feature.</p>
<p>‘<strong>Non-confounding redundancy can be fixed in principle by removing the redundant variables from the model</strong> (see below). For example, if we removed Interactions from the model then we will capture the full effect of making a sales call on renewal probability. This removal is also important for double ML, since double ML will fail to capture indirect causal effects if you control for downstream features caused by the feature of interest. In this case double ML will only measure the “direct” effect that does not pass through the other feature. Double ML is however robust to controlling for upstream non-confounding redundancy (where the redundant feature causes the feature of interest), though this will reduce your statistical power to detect true effects. Unfortunately, we often don’t know the true causal graph so it can be hard to know when another feature is redundant with our feature of interest because of observed confounding vs. non-confounding redundancy. If it is because of confounding then we should control for that feature using a method like double ML, whereas if it is a downstream consequence then we should drop the feature from our model if we want full causal effects rather than only direct effects. Controlling for a feature we shouldn’t tends to hide or split up causal effects, while failing to control for a feature we should have controlled for tends to infer causal effects that do not exist. This generally makes controlling for a feature the safer option when you are uncertain.’</p>
<p><strong>When can they not be used? (3) When you have unobserved confounding.</strong> ‘The Discount and Bugs Reported features both suffer from unobserved confounding because not all important variables (e.g., Product Need and Bugs Faced) are measured in the data. Even though both features are relatively independent of all the other features in the model, there are important drivers that are unmeasured. In this case, both predictive models and causal models that require confounders to be observed, like double ML, will fail. This is why double ML estimates a large negative causal effect for the Discount feature even when controlling for all other observed features’</p>
<p>‘Specialized causal tools based on the principals of instrumental variables, differences-in-differences, or regression discontinuities can sometimes exploit partial randomization even in cases where a full experiment is impossible. For example, instrumental variable techniques can be used to identify causal effects in cases where we cannot randomly assign a treatment, but we can randomly nudge some customers towards treatment, like sending an email encouraging them to explore a new product feature. Difference-in-difference approaches can be helpful when the introduction of new treatments is staggered across groups. Finally, regression discontinuity approaches are a good option when patterns of treatment exhibit sharp cut-offs (for example qualification for treatment based on a specific, measurable trait like revenue over $5,000 per month).’</p>
<p><a class="reference external" href="https://shap.readthedocs.io/en/latest/example_notebooks/overviews/Be%20careful%20when%20interpreting%20predictive%20models%20in%20search%20of%20causal%20insights.html#">[source]</a></p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="design_causal_estimands.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Causal estimands</p>
      </div>
    </a>
    <a class="right-next"
       href="design_methods_2_conventional.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Methods #2: Conventional approaches</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#designing-a-study-to-estimate-a-causal-effect-from-observational-data">Designing a study to estimate a causal effect from observational data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#groups-of-methods-for-causal-effect-estimation">Groups of methods for causal effect estimation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#conditional-v-s-marginal-effect-measures">Conditional v.s. marginal effect measures</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#current-practice">Current practice</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mapping-review-of-confounding-adjustment-methods-used-for-longitudinal-observational-data">2022 mapping review of confounding adjustment methods used for longitudinal observational data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-you-shouldn-t-do">What you shouldn’t do</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#all-possible-confounders">All possible confounders</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-driven-selection-of-confounders">Data-driven selection of confounders</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adjust-for-time-varying-confounders-using-conventional-methods">Adjust for time-varying confounders using conventional methods</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rough-notes">ROUGH NOTES…</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#additional-counterfactual-prediction-modelling">Additional: counterfactual prediction modelling</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#when-can-prediction-models-answer-causal-questions">When can prediction models answer causal questions?</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Amy Heather
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>